# =============================================================================
# backend/.env  — Variáveis de ambiente para o BACKEND
# =============================================================================

# -----------------------------
# Database (usado pelo backend)
# -----------------------------
# Nota: ajuste se seu docker-compose usa outros user/password/db
DATABASE_URL=postgresql+psycopg2://postgres:postgres@db:5432/db-1

# -----------------------------
# Mercado Livre (OAuth) — app
# -----------------------------
# Estes valores vieram do painel do Mercado Livre (ID / secret / redirect URI)
ML_CLIENT_ID=6377568852501213
ML_CLIENT_SECRET=MKxO9QvJvpg7ivkW7lYbN1nCwbjw6J6l

# URI de redirect PRINCIPAL — deve ser IDÊNTICA à registrada no painel ML.
# O seu painel mostrava: https://53c1c7c61049.ngrok-free.app/
# Use exatamente essa se o app no ML estiver cadastrado com ela.
ML_REDIRECT_URI=https://53c1c7c61049.ngrok-free.app/api/oauth/callback
# Opcional: URI local para DEV (utilize apenas se você registrar esta URI no painel ML)
# ML não aceitará esse valor a menos que você o adicione nos URIs de redirect do app ML.
ML_REDIRECT_URI_LOCAL=http://localhost:8000/api/oauth/callback

# Endpoints do Mercado Livre
ML_AUTH_URL=https://auth.mercadolibre.com.br/authorization
ML_TOKEN_URL=https://api.mercadolibre.com/oauth/token
ML_SITE_ID=MLB

# Scopes desejados (ajuste conforme permissões que você selecionou no painel)
ML_SCOPES=offline_access read write

# ==============================
# PKCE (recomendado / ativo no painel)
# ==============================
# O painel indicou "PKCE necessário" — deixe true e implemente PKCE no backend.
ML_USE_PKCE=true
# Método de challenge (normalmente S256)
PKCE_CODE_CHALLENGE_METHOD=S256
# Observação: NÃO fixe um CODE_VERIFIER em .env para produção.
# O code_verifier deve ser gerado dinamicamente por authorization request e armazenado por sessão (db/cookie).
# (Ex.: gerar base64-url 43..128 bytes, calcular SHA256 e base64-url => code_challenge)

# -----------------------------
# Application URLs
# -----------------------------
# URL pública do backend (use a do ngrok em produção dev)

BASE_URL=https://a2ccef5d898a.ngrok-free.app
OAUTH_CALLBACK_PATH=/api/oauth/callback
MERCADO_LIBRE_APP_ID=SEU_APP_ID
MERCADO_LIBRE_SECRET=SEU_APP_SECRET

FRONTEND_ORIGIN=http://localhost:3000

# URL interna entre containers (quando o frontend/backend chamam internamente no Docker)
BACKEND_INTERNAL_URL=http://backend:8000

# -----------------------------
# JWT / Segurança
# -----------------------------
SECRET_KEY=43412b4f578bc4fa5dbe72897926a19b3dc04ebc5f7bb56df0d3578e4eb900d9
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=60
REFRESH_TOKEN_EXPIRE_DAYS=7

# -----------------------------
# Runtime / Misc
# -----------------------------
ENV=development

# Workaround para aviso de depreciação do pkg_resources no passlib (opcional)
SETUPTOOLS_USE_PKG_RESOURCES=false
